/*
 * TipTip
 * Copyright 2010 Drew Wilson
 * www.drewwilson.com
 * code.drewwilson.com/entry/tiptip-jquery-plugin
 *
 * Modified by: indyone (https://github.com/indyone/TipTip)
 * Modified by: Jonathan Lim-Breitbart (https://github.com/breity/TipTip) - Updated: Oct. 10, 2012
 *
 * Version 1.3   -   Updated: Mar. 23, 2010
 *
 * This TipTip jQuery plug-in is dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */
(function(e){function i(e){return r.test(e)}e.fn.tipTip=function(t){var n={activation:"hover",keepAlive:!1,maxWidth:"200px",edgeOffset:0,defaultPosition:"bottom",delay:400,delayHover:500,fadeIn:200,fadeOut:200,attribute:"title",content:!1,enter:function(){},afterEnter:function(){},exit:function(){},afterExit:function(){},cssClass:"",detectTextDir:!0};if(e("#tiptip_holder").length<=0){var r=e("<div>",{id:"tiptip_arrow_inner"}),s=e("<div>",{id:"tiptip_arrow"}).append(r),o=e("<div>",{id:"tiptip_content"}),u=e("<div>",{id:"tiptip_holder"}).append(s).append(o);e("body").append(u)}else var u=e("#tiptip_holder"),o=e("#tiptip_content"),s=e("#tiptip_arrow");return this.each(function(){function p(){if(f.enter.call(r,l)===!1)return;var t;f.content?t=e.isFunction(f.content)?f.content.call(r,l):f.content:(t=f.content=r.attr(f.attribute),r.removeAttr(f.attribute));if(!t)return;o.html(t),u.hide().removeAttr("class").css({"max-width":f.maxWidth}),f.cssClass&&u.addClass(f.cssClass),v(),c&&clearTimeout(c),c=setTimeout(function(){u.stop(!0,!0).fadeIn(f.fadeIn)},f.delay),e(window).bind("resize.tipTip scroll.tipTip",v),r.addClass("tiptip_visible"),f.afterEnter.call(r,l)}function d(){if(f.exit.call(r,l)===!1)return;c&&clearTimeout(c),u.fadeOut(f.fadeOut,function(){e(this).css({left:"",top:"",height:"",width:""})}),e(window).unbind("resize.tipTip scroll.tipTip"),r.removeClass("tiptip_visible"),f.afterExit.call(r,l)}function v(){function L(){m=g.top,h=n-v-f.edgeOffset-E/2,p=a+(l-d)/2}function A(){m=g.bottom,h=n+c+f.edgeOffset,p=a+(l-d)/2}function O(){m=g.left,h=n+(c-v)/2,p=a-d-f.edgeOffset-w/2}function M(){m=g.right,h=n+(c-v)/2,p=a+l+f.edgeOffset}var t=r.offset(),n=t.top,a=t.left,l=r.outerWidth(),c=r.outerHeight(),h,p,d=u.outerWidth(),v=u.outerHeight(),m,g={top:"tip_top",bottom:"tip_bottom",left:"tip_left",right:"tip_right"},y,b,w=12,E=12,S=e(window),x=S.scrollTop(),T=S.scrollLeft(),N=S.width(),C=S.height(),k=f.detectTextDir&&i(o.text());f.defaultPosition=="bottom"?A():f.defaultPosition=="top"?L():f.defaultPosition=="left"&&!k?O():f.defaultPosition=="left"&&k?M():f.defaultPosition=="right"&&!k?M():f.defaultPosition=="right"&&k?O():A(),m==g.left&&!k&&p<T?M():m==g.left&&k&&p-d<T?M():m==g.right&&!k&&p>T+N?O():m==g.right&&k&&p+d>T+N?O():m==g.top&&h<x?A():m==g.bottom&&h>x+C&&L();if(m==g.left||m==g.right)h+v>C+x?h=n+c>C+x?n+c-v:C+x-v-4:h<x&&(h=n<x?n:x+4);if(m==g.top||m==g.bottom)p+d>N+T?p=a+l>N+T?a+l-d:N+T-d-4:p<T&&(p=a<T?a:T+4);u.css({left:Math.round(p),top:Math.round(h)}).removeClass(g.top).removeClass(g.bottom).removeClass(g.left).removeClass(g.right).addClass(m),m==g.top?(y=v,b=a-p+(l-w)/2):m==g.bottom?(y=0,b=a-p+(l-w)/2):m==g.left?(y=n-h+(c-E)/2,b=d):m==g.right&&(y=n-h+(c-E)/2,b=0),s.css({left:Math.round(b),top:Math.round(y)})}var r=e(this),a=r.data("tipTip"),f=a&&a.options||e.extend({},n,t),l={holder:u,content:o,arrow:s,options:f};if(a)switch(t){case"show":p();break;case"hide":d();break;case"destroy":r.unbind(".tipTip").removeData("tipTip");break;case"position":v()}else{var c=!1,h=!1;r.data("tipTip",{options:f}),f.activation=="hover"?r.bind("mouseenter.tipTip",function(){f.delayHover?h=setTimeout(function(){p()},f.delayHover):p()}).bind("mouseleave.tipTip",function(){h&&clearTimeout(h),f.keepAlive?(u.one("mouseleave.tipTip",function(){d()}),e("html").off("click.tipTip").on("click.tipTip",function(t){u.css("display")=="block"&&!e(t.target).closest("#tiptip_holder").length&&(e("html").off("click.tipTip"),d())})):d()}):f.activation=="focus"?r.bind("focus.tipTip",function(){p()}).bind("blur.tipTip",function(){d()}):f.activation=="click"?r.bind("click.tipTip",function(e){return e.preventDefault(),p(),!1}).bind("mouseleave.tipTip",function(){f.keepAlive?(u.one("mouseleave.tipTip",function(){d()}),e("html").off("click.tipTip").on("click.tipTip",function(t){u.css("display")=="block"&&!e(t.target).closest("#tiptip_holder").length&&(e("html").off("click.tipTip"),d())})):d()}):f.activation=="manual"}})};var t="A-Za-z\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02b8\u0300-\u0590\u0800-\u1fff\u2c00-\ufb1c\ufdfe-\ufe6f\ufefd-\uffff",n="\u0591-\u07ff\ufb1d-\ufdfd\ufe70-\ufefc",r=new RegExp("^[^"+t+"]*["+n+"]")})(jQuery);